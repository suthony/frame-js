function do_ImageBrowser(uiJson){this.type="do_ImageBrowser";var that=this;this.uiType=2;this.show=show;function show(data,index){eval(getArgs(arguments,{data:null,index:0,turn:["data","index"]}));var timestamp=(new Date).getTime();var iframe=document.createElement("iframe");iframe.name=timestamp;iframe.width="100%";iframe.height="100%";iframe.style.position="absolute";iframe.style.willChange="transform";iframe.style.zIndex="100";iframe.style.transform="transition3d(0,0,0)";iframe.style.top="0px";iframe.style.animation="slide_r2l 0.5s";var topWindow=window.top;var body=topWindow.document.getElementById("body");body.appendChild(iframe);var div=document.createElement("div");for(var key in this.style)div.style[key]=this.style[key];console.log(document.body.offsetHeight);div.style.width=document.body.offsetWidth+"px";div.style.height="100%";div.style.overflowX="scroll";div.style.overflowY="hidden";var innerDIV=document.createElement("div");innerDIV.style.position="absolute";innerDIV.style.height="100%";innerDIV.style.width="100%";for(var i=0;i<data.length;++i){var oneDIV=document.createElement("div");var source=data[i].source;var init=data[i].init;var img=document.createElement("img");img.src=source;img.onerror=function(){img.src=init;this.onerror=null};img.width=document.body.offsetWidth;img.style.display="inline-block";img.style.position="absolute";img.style.left=i*document.body.offsetWidth+"px";oneDIV.appendChild(img);innerDIV.style.display="table-cell";innerDIV.style.verticalAlign="middle";innerDIV.appendChild(img)}div.appendChild(innerDIV);var style=document.createElement("style");style.innerHTML="*{font-size:16px; padding: 0px;margin: 0px;border: none;}";topWindow.frames[timestamp].document.body.appendChild(style);topWindow.frames[timestamp].document.body.appendChild(div)}this.onDOMCreated=function(){var that=this;var newPosition=null;var firstVisiblePositionTemp=null;var lastVisiblePositionTemp=null;var rate=1.4;var startX;var totalTranslateX=0;this.DOMElement.addEventListener("touchmove",function(event){event.preventDefault();var pageX=event.changedTouches[0].pageX;var translateX=totalTranslateX+pageX*rate-startX;that.DOMElement.children[0].style["will-change"]="transform";that.DOMElement.children[0].style["transition-property"]="transform";that.DOMElement.children[0].style["transition-duration"]="0ms";that.DOMElement.children[0].style["transform"]="translate3d("+translateX+"px, 0px, 0px)"});this.DOMElement.addEventListener("touchstart",function(event){startX=event.changedTouches[0].pageX*rate});this.DOMElement.addEventListener("touchend",function(event){var pageX=event.changedTouches[0].pageX;totalTranslateX+=pageX*rate-startX;that.DOMElement.children[0].style["transition-duration"]="300ms";var toIndex=Math.round(-totalTranslateX/getRealSize(parseInt(that.width)));if(toIndex<0)toIndex=0;if(toIndex>=that.childrenVirtualNodes.length)toIndex=that.childrenVirtualNodes.length-1;var translateX=getRealSize(toIndex*parseInt(that.width));totalTranslateX=-translateX;that.DOMElement.children[0].style["transform"]="translate3d(-"+translateX+"px, 0px, 0px)";that.fire("indexChanged",toIndex)});this.DOMElement.addEventListener("click",function(event){var pageX=event.pageX;var childrenDOMElements=that.childrenVirtualNodes;for(var i=0;i<childrenDOMElements.length;++i){var child=childrenDOMElements[i].DOMElement;var x1=child.getBoundingClientRect().left;var x2=x1+child.getBoundingClientRect().width;if(pageX>x1&&pageX<x2){that.fire("touch",i);break}}})};this.render=function(){var div=this.DOMElement?this.DOMElement:document.createElement("div");for(var key in this.style)div.style[key]=this.style[key];div.style.overflowX="scroll";div.style.overflowY="hidden";div.style.position="relative";div.innerHTML="";var innerDIV=document.createElement("div");if(this.childrenVirtualNodes)for(var i=0;i<this.childrenVirtualNodes.length;++i){var virtualNode=this.childrenVirtualNodes[i];var dom=virtualNode.getDOMElememt();dom.style.display="inline-block";dom.style.position="absolute";dom.style.top="0px";dom.style.left=i*getRealSize(parseInt(this.width))+"px";innerDIV.appendChild(dom)}div.appendChild(innerDIV);return div};SM.call(this,uiJson)}(function(){var Super=function(){};Super.prototype=SM.prototype;do_ImageBrowser.prototype=new Super})();